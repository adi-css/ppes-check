<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>PPES-Inspired Postpartum Psychotic Experiences Self-Check</title>
  <style>
    :root{--bg:#f7fbff;--card:#ffffff;--muted:#6b7280;--accent:#1f6feb;--danger:#dc2626;--ok:#059669}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;color:#0f172a;background:linear-gradient(180deg,var(--bg),#eef6ff)}
    .container{max-width:880px;margin:28px auto;padding:20px}
    header{display:flex;align-items:flex-start;gap:16px}
    h1{font-size:20px;margin:0}
    p.lead{margin:6px 0 12px;color:var(--muted)}
    .card{background:var(--card);border-radius:12px;padding:18px;box-shadow:0 8px 20px rgba(15,23,42,0.06)}
    table{width:100%;border-collapse:collapse;margin-top:12px}
    th,td{padding:10px 8px;text-align:left;border-bottom:1px solid #eef2ff;font-size:14px}
    th.statement{width:64%}
    .radios{display:flex;gap:6px}
    .radios label{display:inline-flex;align-items:center;justify-content:center;width:34px;height:34px;border-radius:6px;border:1px solid #e6eefc;cursor:pointer}
    .radios input{display:none}
    .radios input:checked + span{background:var(--accent);color:white;border-color:var(--accent)}
    .controls{display:flex;gap:12px;flex-wrap:wrap;margin-top:14px}
    button{background:var(--accent);color:white;border:0;padding:10px 14px;border-radius:8px;cursor:pointer;font-weight:600}
    button.secondary{background:#eef2ff;color:var(--accent)}
    .result{margin-top:12px;padding:12px;border-radius:8px}
    .result.low{background:#f0fdf4;color:var(--ok);border:1px solid #d1fae5}
    .result.mid{background:#fffbeb;color:#92400e;border:1px solid #fef3c7}
    .result.high{background:#fff1f2;color:var(--danger);border:1px solid #fecaca}
    .note{font-size:13px;color:var(--muted);margin-top:8px}
    .highlight{font-weight:700}
    footer{font-size:13px;color:var(--muted);margin-top:14px}
    @media (max-width:720px){.radios label{width:28px;height:28px;font-size:12px}.th.statement{display:block}}
  </style>
</head>
<body>
  <div class="container">
    <div class="card">
      <header>
        <div>
          <h1>ðŸ§  Postpartum Psychotic Experiences Self-Check (PPES-Inspired)</h1>
          <p class="lead">For self-reflection only. This is <strong>not</strong> a diagnostic test. If you or someone you know has thoughts of harm, hallucinations, strong confusion, or immediate danger, seek emergency or professional help now.</p>
        </div>
      </header>

      <form id="ppesForm" aria-labelledby="ppesTitle">
        <table role="table">
          <thead>
            <tr>
              <th class="statement">Statement</th>
              <th>0</th>
              <th>1</th>
              <th>2</th>
              <th>3</th>
              <th>4</th>
            </tr>
          </thead>
          <tbody id="items">
          </tbody>
        </table>

        <div class="controls">
          <button type="button" id="scoreBtn">Calculate score</button>
          <button type="button" id="clearBtn" class="secondary">Clear answers</button>
          <button type="button" id="printBtn" class="secondary">Print / Save PDF</button>
        </div>

        <div id="result" class="result" style="display:none"></div>
        <p class="note">Scoring (informal): add your answers (0â€“60). 0â€“8: likely typical adjustment. 9â€“20: mild/occasional â€” consider sharing with a provider. 21+ or any item rated 3/4: consider seeking professional help soon. If you have thoughts of harming yourself or your baby, seek emergency help immediately.</p>
      </form>

      <footer>
        <strong>Reminder:</strong> This tool is for awareness only and does not replace medical or psychiatric assessment. If you are concerned, contact a healthcare professional or your local emergency number.
      </footer>
    </div>
  </div>

  <script>
    const statements = [
      "Iâ€™ve felt unusually confused or disoriented about time, place, or people.",
      "Iâ€™ve noticed or heard things that others said they couldnâ€™t see or hear.",
      "Iâ€™ve felt that people or forces were trying to control my thoughts or actions.",
      "My thoughts have seemed jumbled, racing, or disconnected.",
      "Iâ€™ve believed things others told me were unlikely or untrue.",
      "Iâ€™ve felt extremely energized or invincible even with little sleep.",
      "Iâ€™ve found it difficult to tell whatâ€™s real and whatâ€™s not.",
      "My emotions have shifted quickly from joy to fear or sadness without reason.",
      "Iâ€™ve had intrusive thoughts about my baby that scared or disturbed me.",
      "Iâ€™ve felt detached from my baby or unsure if the baby is mine.",
      "Iâ€™ve had strong feelings of being watched, judged, or followed.",
      "Iâ€™ve felt my mind going blank or unable to think clearly.",
      "Iâ€™ve experienced sudden bursts of fear or panic without a clear reason.",
      "Iâ€™ve said or done things that didnâ€™t feel like 'me.'",
      "Iâ€™ve struggled to recognize familiar people or surroundings."
    ];

    const tbody = document.getElementById('items');
    statements.forEach((s, i) => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td class="statement"><label for="q${i}">${i+1}. ${s}</label></td>
        ${[0,1,2,3,4].map(v=>`<td>
            <div class="radios">
              <label>
                <input type="radio" name="q${i}" value="${v}" />
                <span>${v}</span>
              </label>
            </div>
          </td>`).join('')}
      `;
      tbody.appendChild(tr);
    });

    function getAnswers(){
      const answers = [];
      for(let i=0;i<statements.length;i++){
        const el = document.querySelector(`input[name=q${i}]:checked`);
        answers.push(el ? parseInt(el.value,10) : null);
      }
      return answers;
    }

    function calculate(){
      const answers = getAnswers();
      const missing = answers.filter(a=>a===null).length;
      if(missing>0){
        if(!confirm(`You have ${missing} unanswered item(s). Continue and calculate with unanswered treated as 0?`)) return;
        for(let i=0;i<answers.length;i++) if(answers[i]===null) answers[i]=0;
      }
      const total = answers.reduce((s,v)=>s+v,0);
      const anyHigh = answers.some(v=>v>=4);
      const anyOften = answers.some(v=>v>=3);

      const resultEl = document.getElementById('result');
      resultEl.style.display='block';

      let html = `<div><strong>Total score: ${total} / 60</strong></div>`;
      if(total<=8){
        resultEl.className='result low';
        html += `<p>You are likely within a typical range for postpartum adjustment. Take care of rest, nutrition, and emotional support.</p>`;
      } else if(total<=20 && !anyOften){
        resultEl.className='result mid';
        html += `<p>Mild or occasional unusual experiences. Consider sharing with a healthcare provider or counselor if you feel worried.</p>`;
      } else {
        resultEl.className='result high';
        html += `<p>Score suggests frequent/intense experiences. It's important to seek professional help soon. If you have thoughts of harming yourself or your baby, seek emergency help immediately.</p>`;
      }

      // Highlight items rated 3 or 4
      const flagged = [];
      answers.forEach((v, idx)=>{ if(v>=3) flagged.push({idx:idx+1, val:v, text: statements[idx]}); });
      if(flagged.length){
        html += `<hr><div><strong>Items rated often/always (3 or 4):</strong><ul>`;
        flagged.forEach(f=> html+=`<li><span class="highlight">#${f.idx} (rating ${f.val})</span>: ${escapeHtml(f.text)}</li>`);
        html += `</ul></div>`;
      }

      html += `<div style="margin-top:10px;font-size:13px;color:${'#374151'}">This tool is for awareness only and does not replace a professional assessment.</div>`;
      resultEl.innerHTML = html;
      // move to result
      resultEl.scrollIntoView({behavior:'smooth',block:'center'});
    }

    function escapeHtml(str){ return str.replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;'); }

    document.getElementById('scoreBtn').addEventListener('click', calculate);
    document.getElementById('clearBtn').addEventListener('click', ()=>{
      document.querySelectorAll('input[type=radio]').forEach(r=>r.checked=false);
      const res = document.getElementById('result'); res.style.display='none'; res.innerHTML='';
    });
    document.getElementById('printBtn').addEventListener('click', ()=>window.print());

    // accessibility: allow keyboard navigation of radio groups by arrow keys
    document.addEventListener('keydown', (e)=>{
      if(!['ArrowLeft','ArrowRight','ArrowUp','ArrowDown'].includes(e.key)) return;
      const active = document.activeElement;
      if(!active || active.tagName!=='INPUT' || active.type!=='radio') return;
      const name = active.name;
      const radios = Array.from(document.querySelectorAll(`input[name=${name}]`));
      const idx = radios.indexOf(active);
      if(idx===-1) return;
      e.preventDefault();
      if(e.key==='ArrowRight' || e.key==='ArrowDown'){
        const next = radios[(idx+1)%radios.length]; next.focus(); next.checked=true;
      } else {
        const prev = radios[(idx-1+radios.length)%radios.length]; prev.focus(); prev.checked=true;
      }
    });
  </script>
</body>
</html>
